\section{Neuron as an Agent}

NaaA では、各ニューロンをエージェントと位置付ける。
エージェント間の通信は一つのマシン内で行われてもよいし、マシン間で行われてもよい。
以下では、ニューロン、ユニット、エージェントは断りのない限りすべて同じ意味で用いることにする。

% ユニットの計算方法
ユニットの計算方法は、既存のニューラルネットワークとほとんど同じである。
ユニットは、一つのスカラー値を信号として出力する。
この信号は、他のユニットから受けた入力に基づき計算される。
線形演算、すなわち重み付き和を計算するユニットもあれば、
ReLU のような活性を計算するユニットも存在する。

% 
ユニットを一つのエージェントとみなすことで、最適化する対象の問題はマルチエージェント強化学習とみなすことができる。
マルチエージェント強化学習における問題とは、環境が与えた報酬 $R_0$ を複数のエージェント間でどのように分配するかにある。
%強化学習における信頼度割り当て

まず、各エージェントが受け取る報酬の総和はが環境が与える報酬に対して等しい必要がある。すなわち、次の式が成立する。
\begin{flalign}
R_{0t} = \sum_{i=1}^n R_{it}
\end{flalign}
これを変形すると、次のようになる。
\begin{flalign}
R_{jt} = R_{0t} - \sum_{i=1, }^n R_{it}
\end{flalign}
したがって、次の式が成立する必要がある。
%\begin{flalign}
%\sum_{i=1}^n r_{it} = \sum_{i=1}^n c_{it}
%\end{flalign}

% 何が異なるか
NaaA におけるユニットがこれまでのユニットと異なる点は、
ユニット間の通信が信号の一方的な流れではなく、取引、
すなわち信号と資金の交換である点である。
%ユニットが他のユニットから信号を受け取る際は、資金を払う必要がある。

説明を簡単にするために、最初に 2 つのユニットで構成される売り手-買い手モデル(seller-buyer model)を考える。
このモデルは、売り手のユニットが信号を計算し、計算した値に対して値段を付けて買い手に対して提示(ask)する。
買い手は、買取価格を入札(bid)する。もし、希望価格(ask price)が入札価格(bid price)を下回れば、希望価格と入札価格の間の価格で合意し、買い手は売り手に対して価格を考える。
Seller-buyer モデルの問題は、買い手が値切れてしまうことである。
これは対戦略性を持たないと呼ばれる。
希望価格を決定する根拠を持たない点にある。

NaaA では、ユニットの出力を、デジタル財、すなわち、供給が無限に存在する財とみなした資源の最適配分について考える。


メカニズムデザインでは、環境は $(N, \Theta, 0)$ で表現される。

ここで重要なのは、最適な価格の決定方法である。
次に、一つのユニットと複数のユニットからなるモデル、seller-buyers モデルを考える。
一つのユニットは、複数のユニットに対して、情報を売る。


ユニットは入力ユニットに対して、

取引は、ユニットは他のニューロンに対して定価

出力値は、他のユニットに対してそのユニットの定価 $a_it$ で売却する
したがって、

これまでのニューラルネットワークの目的は、予測誤差 $e$ にあった。
そのため、各ユニットはバックプロパゲーションによって $\partial e / \partial y$ を受け取り、
$e$ が小さくなる方向に $y$ の大きさを制御していた。
NaaA において、エージェントの目的は大域的誤差の最小化ではなく、エージェント自身の利益の最大化である。
ここで、利益とは、エージェントが受け取る売上と、支払うコストの差である。
すなわち、各エージェントは次の関数を最大化する。
\begin{flalign}
R_t = r_t - c_t
\end{flalign}
エージェントの目的関数は次のように表現される。
\begin{flalign}
\Expect{\pi}{\sum_{i=0}^{T} \gamma^i (r_{t+i} - c_{t+i})}
&= \Expect{\pi}{\sum_{i=0}^{T} \gamma^i r_{t+i}} -  \Expect{\pi}{\sum_{i=0}^{T} \gamma^ic_{t+i}} \\
&= G_t^{\mathrm{in}} - G_t^{\mathrm{out}}
\end{flalign}
ただし、$G_t^{\mathrm{in}} \equiv \Expect{\pi}{\sum_{i=0}^{T} \gamma^i r_{t+i}}$、
$G_t^{\mathrm{out}} \equiv \Expect{\pi}{\sum_{i=0}^{T} \gamma^ic_{t+i}}$ である。
この式は、エージェントが終端状態までに生み出した付加価値に等しい。
これを行うために、エージェントは売上の最大化とコストの最小化を同時に行うことがわかる。

この式を通常の枠組みに沿って解くと、コスト最小化によってエージェントは他のエージェントに対して金額を支払わないことが正解となる。
そのため、すべてのエージェントがフリーライダーとなり、全体としての報酬が下がるという、パレート劣位問題が発生する。
NaaA ではこれを回避するため、オークションの仕組みを用いて、同じユニットの出力先にあるユニットを競争させることによって最適価格を決定する。

ここで、売上とコストの選定方法について分けて説明を行う。
まず、売上について考える。エージェントは
\begin{flalign}
r_t = \max_{a_t} a_t d_t(a_t) 
\end{flalign}
\begin{flalign}
c_t = b_t + o_t + k_t
\end{flalign}


% method
